<?xml version="1.0" encoding="UTF-8"?>
<ctl:package xmlns:ctl="http://www.occamlab.com/ctl"
	xmlns:gml="http://www.opengis.net/gml"
	xmlns:html="http://www.w3.org/1999/xhtml"
	xmlns:ogc="http://www.opengis.net/ogc"
	xmlns:ows="http://www.opengis.net/ows/1.1"
	xmlns:parsers="http://www.occamlab.com/te/parsers"
	xmlns:saxon="http://saxon.sf.net/"
	xmlns:te="http://www.occamlab.com/te"
	xmlns:tep="http://teamengine.sourceforge.net/parsers"
	xmlns:xi="http://www.w3.org/2001/XInclude"
	xmlns:xlink="http://www.w3.org/1999/xlink"
	xmlns:xml="http://www.w3.org/XML/1998/namespace"
	xmlns:xsd="http://www.w3.org/2001/XMLSchema"
	xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:wmts="http://www.opengis.net/wmts/1.0"
	xmlns:ctlFunctions="https://cite.opengeospatial.org/wmts-1.0.0/src/ctl/ctlFunctions.xml"
	xmlns:owsFunctions="https://cite.opengeospatial.org/wmts-1.0.0/src/ctl/owsFunctions.xml"
	xmlns:wwwFunctions="https://cite.opengeospatial.org/wmts-1.0.0/src/ctl/wwwFunctions.xml"
	xmlns:wmtsFunctions="https://cite.opengeospatial.org/wmts-1.0.0/src/ctl/wmtsFunctions.xml"
	xmlns:wmtsBootstrap="https://cite.opengeospatial.org/wmts-1.0.0/src/ctl/bootstrap.xml">

	<ctl:test name="wmts:SimpleProfile.Schematron">
		<ctl:param name="doc" />
		<ctl:assertion>Validate an XML instance against a Schematron schema using the default phase.</ctl:assertion>
		<ctl:code>
			<xsl:choose>
				<xsl:when test="empty($doc)">
					<ctl:message>Error: Null input document.</ctl:message>
					<ctl:fail />
				</xsl:when>
				<xsl:otherwise>
					<xsl:variable name="results">
						<ctl:call-function name="ctl:SchematronValidator">
							<ctl:with-param name="doc"><xsl:copy-of select="$doc" /></ctl:with-param>
							<ctl:with-param name="schema">/sch/wmts/1.0/Capabilities.sch</ctl:with-param>
							<ctl:with-param name="phase">DefaultPhase</ctl:with-param>
						</ctl:call-function>
					</xsl:variable>
					<xsl:if test="count($results/*) > 0">
						<ctl:message>Total number of errors detected:
							<xsl:copy-of select="count($results/*)" />
						</ctl:message>
						<xsl:for-each select="$results/*">
							<ctl:message>
								<xsl:value-of select="concat('Error ', position())" />
								:
								<xsl:copy-of select="." />
							</ctl:message>
						</xsl:for-each>
						<ctl:fail />
					</xsl:if>
				</xsl:otherwise>
			</xsl:choose>
		</ctl:code>
	</ctl:test>
</ctl:package>